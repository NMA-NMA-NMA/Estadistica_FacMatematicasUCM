---
title: "Regresión Multivariante"
subtitle: "ESTADÍSTICA APLICADA (Ingeniería Matemática, UCM): Grupos U1 y U2"
author: "Nirian Martín"
date-format: "DD/MM/YYYY"
date: "`r format(Sys.time())`"
format: html
# format: html
lang: es
output:
  html_document: default
---

```{r setup, include=FALSE} knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
library(plotly)

# Use the predefined 'Viridis' colorscale
mycolors <- 'Viridis'

# Create the base scatter plot
p1 <- plot_ly(mtcars,
              x = ~ hp,
              y = ~ disp,
              z = ~ mpg,
              type = "scatter3d",
              mode = "markers",
              marker = list(size = 5, color = ~ mpg, colorscale = mycolors))
p1

# Generate sample grid for surface plot
hp_seq <- seq(min(mtcars$hp), max(mtcars$hp), by = 10)
disp_seq <- seq(min(mtcars$disp), max(mtcars$disp), by = 10)
grid_wide <- outer(hp_seq, disp_seq, function(hp, disp) {
  predict(lm(mpg ~ hp + disp, data = mtcars),
          newdata = data.frame(hp = hp, disp = disp))
})

# Add the surface plot with the predefined 'Viridis' colorscale
p2 <- add_surface(p1,
                  z = grid_wide,
                  x = hp_seq,
                  y = disp_seq,
                  colorscale = mycolors)
p2
```